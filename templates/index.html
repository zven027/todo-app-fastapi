<!DOCTYPE html>
<!-- prettier-ignore -->
<html>
  <head>
    <title>ToDoãƒªã‚¹ãƒˆ</title>
    <style>
      body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #f8f9fa;
        padding: 2rem;
      }
      
      h1 {
        font-size: 2rem;
        color: #2c3e50;
      }
      
      h2 {
        font-size: 1.3rem;
        margin-top: 2rem;
        color: #2c3e50;
      }
      
      form {
        margin-bottom: 1rem;
      }
      
      input[type='text'] {
        padding: 6px;
        border: 1px solid #ccc;
        border-radius: 4px;
        margin-right: 6px;
      }
      
      button {
        background-color: #3498db;
        border: none;
        color: white;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
        margin-right: 6px;
      }
      
      button:hover {
        background-color: #2980b9;
      }
      
      .task-item {
        background-color: #fff;
        padding: 1rem;
        border-radius: 6px;
        box-shadow: 0 0 3px rgba(0, 0, 0, 0.1);
        margin-bottom: 1rem;
      }
      
      .task-title {
        font-weight: bold;
        font-size: 1.1rem;
        margin-bottom: 0.4rem;
      }
      
      .task-title.done {
        color: #999;
        text-decoration: line-through;
      }
      
      .tag {
        display: inline-block;
        background-color: #f1c40f;
        color: #000;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 0.8rem;
        margin-right: 5px;
        margin-top: 4px;
      }
      
      .filter-tags a {
        margin-right: 10px;
        font-weight: bold;
        text-decoration: none;
        color: #2c3e50;
      }
      
      .filter-tags a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <h1>ğŸ“ ToDoãƒªã‚¹ãƒˆ</h1>

    <h2>ğŸ·ï¸ ã‚¿ã‚°ä¸€è¦§</h2>

    <div class="filter-tags">
      {% for tag in tags %}
        <a href="/filter_by_tag?tag={{ tag.name }}">
          {% if selected_tag == tag.name %}
            <strong>[{{ tag.name }}]</strong>
          {% else %}
            [{{ tag.name }}]
          {% endif %}
        </a>
      {% endfor %}
    </div>

    {% if selected_tag %}
      <p>
        ğŸ” ç¾åœ¨ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼š<strong>{{ selected_tag }}</strong>
        <a href="/">â† ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è§£é™¤</a>
      </p>
    {% endif %}

    <p>
      ğŸ“‚ çŠ¶æ…‹ã§çµã‚Šè¾¼ã¿ï¼š
      <a href="/" style="margin-right: 10px;">ã™ã¹ã¦</a>
      <a href="/?is_done=false" style="margin-right: 10px;">â³ æœªå®Œäº†</a>
      <a href="/?is_done=true">âœ… å®Œäº†</a>
    </p>

    {% if is_done_filter is not none %}
      <p>
        ğŸ” ç¾åœ¨ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼š{% if is_done_filter %}
          âœ… <strong>å®Œäº†æ¸ˆã¿</strong>
        {% else %}
          â³ <strong>æœªå®Œäº†</strong>
        {% endif %}
        <a href="/">â† ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è§£é™¤</a>
      </p>
    {% endif %}


<form method="post" action="/add">
  <input type="text" name="title" placeholder="æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’å…¥åŠ›" />
  <input type="date" name="due_date" />  <!-- â˜… æœŸé™å…¥åŠ›æ¬„ã‚’è¿½åŠ  -->
  <button type="submit">è¿½åŠ </button>
</form>

    {% for task in tasks %}
      <div class="task-item">
        <div class="task-title {% if task.is_done %}done{% endif %}">
          {{ task.title }} {% if task.is_done %}âœ…{% endif %}
        </div>
{% if task.due_date %}
  {% set today = now().date() %}
  {% if task.due_date.date() < today %}
    <div style="color: red;">â° æœŸé™ï¼š{{ task.due_date.strftime('%Y-%m-%d') }}ï¼ˆæœŸé™åˆ‡ã‚Œï¼‰</div>
  {% elif task.due_date.date() == today %}
    <div style="color: orange;">â° æœŸé™ï¼š{{ task.due_date.strftime('%Y-%m-%d') }}ï¼ˆä»Šæ—¥ï¼ï¼‰</div>
  {% else %}
    <div style="color: #2c3e50;">ğŸ“… æœŸé™ï¼š{{ task.due_date.strftime('%Y-%m-%d') }}</div>
  {% endif %}
{% endif %}


        {% if task.tags %}
          <div>
            {% for tag in task.tags %}
              <span class="tag">{{ tag.name }}</span>
            {% endfor %}
          </div>
        {% endif %}

        <form method="post" action="/toggle_done/{{ task.id }}" style="display:inline;">
          <button type="submit">
            {% if task.is_done %}
              æœªå®Œäº†ã«æˆ»ã™
            {% else %}
              âœ…å®Œäº†ã«ã™ã‚‹
            {% endif %}
          </button>
        </form>

        <form method="post" action="/delete/{{ task.id }}" style="display:inline;" onsubmit="return confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
          <button type="submit">ğŸ—‘ï¸ å‰Šé™¤</button>
        </form>
<!-- âœï¸ ç·¨é›†ãƒœã‚¿ãƒ³ã“ã“ã«è¿½åŠ  -->
        <form method="get" action="/edit/{{ task.id }}" style="display:inline;">
          <button type="submit">âœï¸ ç·¨é›†</button>
        </form>
        <form method="post" action="/add_tag/{{ task.id }}" style="display:inline;">
          <input type="text" name="tag_name" placeholder="ã‚¿ã‚°ã‚’è¿½åŠ " />
          <button type="submit">ã‚¿ã‚°è¿½åŠ </button>
        </form>
      </div>
    {% endfor %}

  </body>
</html>
